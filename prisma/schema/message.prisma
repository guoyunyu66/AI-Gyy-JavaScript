enum MessageRole {
  USER // 用户发的消息
  ASSISTANT // AI 助手回复的消息
  SYSTEM // 系统消息 (可选，用于设定AI行为等)
}

model Message {
  id              String       @id @default(cuid()) // 消息ID
  conversation_id String // 关联对话ID
  conversation    Conversation @relation(fields: [conversation_id], references: [id], onDelete: Cascade)
  user_id         String? // 消息发送者 (如果是用户发送)
  user            User?        @relation(fields: [user_id], references: [id], onDelete: SetNull) // onDelete: SetNull 表示如果用户被删除，消息中的user_id设为NULL
  role            MessageRole // 消息角色 (user, assistant, system)
  content         String // 消息内容 (text)
  // raw_content     Json?     // 原始消息内容 (例如包含图片、文件链接等复杂结构)
  // metadata        Json?     // 其他元数据
  created_at      DateTime     @default(now())

  @@index([conversation_id])
  @@index([user_id])
}
